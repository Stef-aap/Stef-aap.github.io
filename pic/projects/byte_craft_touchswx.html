<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"><html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <meta name="generator" content="Website XSL Stylesheet V2.2"><link rel="home" href="index.html" title="Byte Craft Limited"><link rel="up" href="articles.html" title="Articles"><link rel="previous" href="fuzzylogic.html" title="Fuzzy Logic in Embedded Systems"><link rel="next" href="appnotes.html" title="Application Notes"><link rel="first" href="ansic.html" title="ISO/ANSI C"><link rel="stylesheet" href="bcl.css" type="text/css"><title>Touch Sensitive Switch</title></head>

<body class="tabular" bgcolor="white" text="black" link="#0000ff" vlink="#840084" alink="#0000ff"><div id="touchsw" class="webpage"><a name="touchsw"></a><table border="0" cellpadding="0" cellspacing="0" width="100%" summary="Navigation"><tbody><tr><td valign="top" align="left" bgcolor="#f7e5ec" width="225"><p class="navtoc"><a href="index.html"><img align="left" border="0" src="about.gif" alt="Banner"></a><br clear="all"><br><span class="toplevel"><img src="blank.gif" alt="&nbsp;&nbsp;&nbsp;"><a href="catalog.html" title="Information about our products"><img src="closed.gif" alt="&nbsp;" border="0"></a><span class="otherpage"><a href="catalog.html" title="Information about our products">Catalog</a></span><br></span><span class="toplevel"><img src="blank.gif" alt="&nbsp;&nbsp;&nbsp;"><a href="technology.html"><img src="closed.gif" alt="&nbsp;" border="0"></a><span class="otherpage"><a href="technology.html">Technology</a></span><br></span><span class="toplevel"><img src="blank.gif" alt="&nbsp;&nbsp;&nbsp;"><a href="order.html"><img src="closed.gif" alt="&nbsp;" border="0"></a><span class="otherpage"><a href="order.html">Ordering</a></span><br></span><span class="toplevel"><img src="blank.gif" alt="&nbsp;&nbsp;&nbsp;"><a href="demos.html"><img src="leaf.gif" alt="&nbsp;" border="0"></a><span class="otherpage"><a href="demos.html">Demonstration Versions</a></span><br></span><span class="toplevel"><img src="blank.gif" alt="&nbsp;&nbsp;&nbsp;"><a href="productnews.html"><img src="closed.gif" alt="&nbsp;" border="0"></a><span class="otherpage"><a href="productnews.html">What's New</a></span><br></span><span class="toplevel"><img src="blank.gif" alt="&nbsp;&nbsp;&nbsp;"><a href="supnotes.html"><img src="closed.gif" alt="&nbsp;" border="0"></a><span class="otherpage"><a href="supnotes.html">Support Notes</a></span><br></span><span class="toplevel"><img src="blank.gif" alt="&nbsp;&nbsp;&nbsp;"><a href="resources.html"><img src="closed.gif" alt="&nbsp;" border="0"></a><span class="otherpage"><a href="resources.html">Resources</a></span><br></span><span class="toplevel"><img src="blank.gif" alt="&nbsp;&nbsp;&nbsp;"><a href="cresources.html"><img src="leaf.gif" alt="&nbsp;" border="0"></a><span class="otherpage"><a href="cresources.html">C Language Resources</a></span><br></span><span class="toplevel"><img src="blank.gif" alt="&nbsp;&nbsp;&nbsp;"><a href="libraries.html"><img src="closed.gif" alt="&nbsp;" border="0"></a><span class="otherpage"><a href="libraries.html">Libraries</a></span><br></span><span class="toplevel"><img src="blank.gif" alt="&nbsp;&nbsp;&nbsp;"><a href="emulators.html"><img src="leaf.gif" alt="&nbsp;" border="0"></a><span class="otherpage"><a href="emulators.html">Emulator Support</a></span><br></span><span class="toplevel"><img src="blank.gif" alt="&nbsp;&nbsp;&nbsp;"><a href="articles.html"><img src="open.gif" alt="&nbsp;" border="0"></a><span class="ancestor"><a href="articles.html">Articles</a></span><br></span><span class="shrink1"><img src="blank.gif" alt="&nbsp;&nbsp;&nbsp;"><img src="blank.gif" alt="&nbsp;&nbsp;&nbsp;"><a href="ansic.html" title="Embedded programming, C standards, and our contribution."><img src="leaf.gif" alt="&nbsp;" border="0"></a><span class="otherpage"><a href="ansic.html" title="Embedded programming, C standards, and our contribution.">ISO/ANSI C</a></span><br></span><span class="shrink1"><img src="blank.gif" alt="&nbsp;&nbsp;&nbsp;"><img src="blank.gif" alt="&nbsp;&nbsp;&nbsp;"><a href="usbarticle.html" title="An introduction to USB and C, with sample code."><img src="leaf.gif" alt="&nbsp;" border="0"></a><span class="otherpage"><a href="usbarticle.html" title="An introduction to USB and C, with sample code.">USB</a></span><br></span><span class="shrink1"><img src="blank.gif" alt="&nbsp;&nbsp;&nbsp;"><img src="blank.gif" alt="&nbsp;&nbsp;&nbsp;"><a href="fuzzylogic.html" title="Fuzzy Logic adds new design options for embedded programming."><img src="leaf.gif" alt="&nbsp;" border="0"></a><span class="otherpage"><a href="fuzzylogic.html" title="Fuzzy Logic adds new design options for embedded programming.">Fuzzy Logic</a></span><br></span><span class="shrink1"><img src="blank.gif" alt="&nbsp;&nbsp;&nbsp;"><img src="blank.gif" alt="&nbsp;&nbsp;&nbsp;"><a href="touchsw.html" title="Using a port pin to sense voltage."><img src="leaf_002.gif" alt="+" border="0"></a><span class="curpage">Touch Sensitive Switch&nbsp;<img src="pointer.gif" alt="&lt;-"></span><br></span><span class="toplevel"><img src="blank.gif" alt="&nbsp;&nbsp;&nbsp;"><a href="appnotes.html"><img src="closed.gif" alt="&nbsp;" border="0"></a><span class="otherpage"><a href="appnotes.html">Application Notes</a></span><br></span><span class="toplevel"><img src="blank.gif" alt="&nbsp;&nbsp;&nbsp;"><a href="cbook.html"><img src="closed.gif" alt="&nbsp;" border="0"></a><span class="otherpage"><a href="cbook.html">Our Book</a></span><br></span><span class="toplevel"><img src="blank.gif" alt="&nbsp;&nbsp;&nbsp;"><a href="tips.html"><img src="closed.gif" alt="&nbsp;" border="0"></a><span class="otherpage"><a href="tips.html">Hints and Tips</a></span><br></span><span class="toplevel"><img src="blank.gif" alt="&nbsp;&nbsp;&nbsp;"><a href="faq.html"><img src="leaf.gif" alt="&nbsp;" border="0"></a><span class="otherpage"><a href="faq.html">FAQ</a></span><br></span><span class="toplevel"><img src="blank.gif" alt="&nbsp;&nbsp;&nbsp;"><a href="press.html"><img src="closed.gif" alt="&nbsp;" border="0"></a><span class="otherpage"><a href="press.html">Press Releases</a></span><br></span><span class="toplevel"><img src="blank.gif" alt="&nbsp;&nbsp;&nbsp;"><a href="sponsorship.html"><img src="leaf.gif" alt="&nbsp;" border="0"></a><span class="otherpage"><a href="sponsorship.html">Sponsorship</a></span><br></span><span class="toplevel"><img src="blank.gif" alt="&nbsp;&nbsp;&nbsp;"><a href="distrib.html"><img src="leaf.gif" alt="&nbsp;" border="0"></a><span class="otherpage"><a href="distrib.html">Byte Craft Distributors</a></span><br></span><span class="toplevel"><img src="blank.gif" alt="&nbsp;&nbsp;&nbsp;"><a href="forms.html"><img src="closed.gif" alt="&nbsp;" border="0"></a><span class="otherpage"><a href="forms.html">For More Information...</a></span><br></span><span class="toplevel"><img src="blank.gif" alt="&nbsp;&nbsp;&nbsp;"><a href="colophon.html"><img src="leaf.gif" alt="&nbsp;" border="0"></a><span class="otherpage"><a href="colophon.html">About...</a></span><br></span><br></p><div class="abstract"><p class="title"><b>Using C to Sense</b></p><p>You can use a port pin to sense a variable capacitor (varied by the user's finger), to determine finger presses.</p></div></td><td width="2%"><br>
</td><td valign="top" align="left" bgcolor="white" width="600"><h1>Touch Sensitive Switch</h1><p><span class="emphasis"><em>Walter Banks, Byte Craft Limited</em></span></p><p>A touch-sensitive switch is very easy to implement with a microprocessor. The principle of the touch-sensitive switch is
  based on the rate of voltage rise on a capacitor that is supplied with a constant current source. When a constant current
  source is applied to a capacitor, the voltage will rise linearly with time.</p><div class="mediaobject"><table border="0" summary="manufactured viewport for HTML img" cellspacing="0" cellpadding="0"><tbody><tr><td><img src="touchsw1.gif"></td></tr></tbody></table></div><p>The value of <tt>C</tt> is very low when the capacitor is a small plate on a printed circuit board. The value of
  <tt>C</tt> rises significantly when a finger is pressed on the plate, separated by a thin layer of insulation
  material. The number of free electrons in the finger acts like a virtual ground, brought into close proximity to the insulated
  plate; this effectively increases the value of the plate capacitance.</p><p>The
touch-sensitive switch uses a port pin of a microcomputer to sense voltage
on the capacitor. Create a port-controlled   constant current source with
a series 500K resistor, on a single port output pin. Toggling the pin between
0 and 1   will turn off and on the current source. A current step function
is applied to the capacitor, and the capacitor voltage is   measured after
5 microseconds. If the capacitor voltage is higher than the trip voltage
on the port, then the capacitor value is   low and no finger press is detected.
If the voltage has not risen to the trip point on the port, then the capacitor
value is high   and a finger press is detected.</p><p>The following is a practical example of a touch sensitive switch:</p><div class="mediaobject"><table border="0" summary="manufactured viewport for HTML img" cellspacing="0" cellpadding="0"><tbody><tr><td><img src="touchsw2.gif"></td></tr></tbody></table></div><p>The basic construction of the touch switch is a printed circuit pad overlaid with a thin layer of insulating material.
  Heat shrink plastic can be used.</p><p>A port <tt>Pa</tt> puts out a step from 0 to V<sub>cc</sub> through a 0.5M resistor (470K or 560K);
  5 microseconds later, the port at <tt>Pb</tt> samples the value on the touch plate (which is insulated from the
  finger). A sampled 1 indicates nothing touching the plate. A sampled 0 indicates that the capacitor has not charged up to the
  switching threshold of <tt>Pb</tt>.</p><p>I have used these in a variety of ways, usually etching the plate directly on a PC board and using a heat shrink plastic as
  an insulator.</p><p>The following code fragment illustrates the programming approach. The function <tt>touch_switch_init</tt> is
  used to initialize the microprocessor's ports. The function <tt>touch_switch</tt> is called whenever the status of
  the touch switch needs to be determined: <tt>touch_switch</tt> returns a 0 if the switch is not touched, and a 1 if
  it is being pressed.</p><pre class="programlisting">void touch_switch_init (void)<br>  {<br>    /* Set port a to output and<br>           port b to input */<br>    pa_direction = output;<br>    pb_direction = input;<br>  }<br><br>char touch_switch (void)<br>  {<br>    pa.0 = 0;    // Discharge the pin<br>    delay_Ms(1); // Wait<br>    pa.0 = 1;    // Turn on the Constant current source<br>    delay_Us(5); // Wait for 5 u_seconds<br>    if (pb.0 == 1)<br>      return (0);   // No touch detected<br>    else<br>      return (1);   // Touch detected<br>  }<br></pre><p>In simple applications where you need only one or two switches, the following circuit will also work.</p><div class="mediaobject"><table border="0" summary="manufactured viewport for HTML img" cellspacing="0" cellpadding="0"><tbody><tr><td><img src="touchsw3.gif"></td></tr></tbody></table></div><p>This requires a single port bit, that outputs a 0 and discharges the capacitive switch. The port data direction is changed
  and sampled 5 microseconds later. A 0 indicates the presence of a finger, and a 1 the absence of a finger. Use the following
  code fragment with this circuit.</p><pre class="programlisting">char touch_switch (void)<br>  {<br>    pb_direction = output;<br>    pb.0 = 0;             // Discharge the pin<br>    delay_Ms(1);          // Wait<br>    pb_direction = input; // Turn on the Constant current source<br>    delay_Us(5);          // Wait for 5 u_seconds<br>    if (pb.0 == 1)<br>      return (0);         // No touch detected<br>    else<br>      return (1);         // Touch detected<br>  }<br></pre><br></td></tr></tbody></table><div class="navfoot"><hr><table width="100%" border="0" summary="Footer navigation"><tbody><tr><td width="33%" align="left"><span class="footdate"></span><br>
</td><td width="34%" align="center"><span class="foothome"><a href="index.html">Home</a></span></td><td width="33%" align="right"><span class="footfeed"><a href="mailto:info@bytecraft.com">Feedback</a></span></td></tr><tr><td colspan="3" align="right"><span class="footcopy"><span class="copyright">Copyright &copy; 2002 Byte Craft Limited. </span></span></td></tr></tbody></table></div></div><br>
</body></html>
