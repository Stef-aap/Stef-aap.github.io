<HTML><HEAD><TITLE>PWM control</TITLE>
<STYLE type="text/css"><!--
BODY {
  margin: 5px 5px 5px 5px;
  background-color: #E8E8E8;
}

--></STYLE>
<LINK type="text/css" href="rvf.css" rel=STYLESHEET>
<link rel="icon" href="jalccring_small.gif" type="image/gif"></HEAD>
<BODY>

<P><SPAN class=RVTS1>PWM control</SPAN></P>
<P><SPAN class=RVTS7>This html document is automatically generated by JALcc, from the JAL-sourcefile</SPAN></P>
<P><SPAN class=RVTS7>pwm.jal&nbsp;&nbsp; 06-08-2004</SPAN></P>
<P>&nbsp;&nbsp;</P>
<P><SPAN class=RVTS2>Description&nbsp;</SPAN></P>
<P>library for using the PWM output,&nbsp;</P>
<P>the main program should define frequency, duty-cycle and pin where PWM is&nbsp;</P>
<P>for example through the use of a local copy of PWM_INS.JAL&nbsp;</P>
<P>&nbsp;&nbsp;</P>
<P>const pwm_osc_frequency = 40_000&nbsp;&nbsp; -- pwm frequency in Hz&nbsp;</P>
<P>const pwm_osc_dutycycle = 75&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -- dutycycle in percent&nbsp;</P>
<P>var volatile bit&nbsp; pwm_pin_direction is pin_b3_direction&nbsp; -- pwm pin, for 16F628&nbsp;</P>
<P>&nbsp;&nbsp;</P>
<P>total&nbsp;&nbsp;&nbsp; period time = 4 * (pr2 + 1) * Tclock * Prescaler2&nbsp;</P>
<P>positive period time =&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; duty&nbsp;&nbsp;&nbsp; * Tclock * Prescaler2&nbsp;</P>
<P>&nbsp;&nbsp;</P>
<P>version 1.2 03-11-2002,&nbsp; Stef Mientki&nbsp;</P>
<P>- due to limitations of JAL, calculation of duty cycle was wrong&nbsp;</P>
<P>- some optimization, less memory, les register use&nbsp;</P>
<P>- procedure PWM_START_OSC added&nbsp;</P>
<P>- name of pin_direction changed (to be compatible with macro definitions) version 1.1 16-03-2002,&nbsp; Stef Mienti&nbsp;</P>
<P>procedure pwm_osc_stop added version 1.0 21-01-2002,&nbsp; Stef Mientki&nbsp;</P>
<P>- first release&nbsp;</P>
<P>&nbsp;&nbsp;</P>
<P><SPAN class=RVTS2>Example, 38 kHz IR modulation&nbsp;</SPAN></P>
<P>&nbsp;&nbsp;</P>
<P>&nbsp;&nbsp; -- define all the parameters and include the library&nbsp;</P>
<P>&nbsp;&nbsp; const pwm_osc_frequency = 38_000&nbsp;&nbsp; -- pwm frequency in Hz&nbsp;</P>
<P>&nbsp;&nbsp; const pwm_osc_dutycycle = 50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -- dutycycle in percent&nbsp;</P>
<P>&nbsp;&nbsp; &lt;mac&gt; io_pin&nbsp;&nbsp; pwm_pin = pin_b3&nbsp;</P>
<P>&nbsp;&nbsp;&nbsp;</P>
<P>&nbsp;&nbsp; -- init and start the PWM&nbsp;</P>
<P>&nbsp;&nbsp; pwm_osc_init&nbsp;</P>
<P>&nbsp;&nbsp;&nbsp;</P>
<P>&nbsp;&nbsp; -- stop the PWM&nbsp;</P>
<P>&nbsp;&nbsp; pwm_osc_stop&nbsp;</P>
<P>&nbsp;&nbsp;</P>
<P><SPAN class=RVTS2>License&nbsp;</SPAN></P>
<P>freeware, under the terms of the GNU GPL&nbsp;</P>
<P>Copyright (C) 2002 Stef Mientki&nbsp;</P>
<P>&nbsp;&nbsp;</P>
<P><SPAN class=RVTS1>Version History</SPAN></P>
<P><A class=RVTS4 href="pwm.jal">download&nbsp; pwm.jal</A></P>
<P><A class=RVTS4 href="pwm_source.html">colorcoded HTML&nbsp; pwm_source.html</A></P>
<P>not available</P>
<P><SPAN class=RVTS2>Included Files</SPAN></P>
<P>&nbsp;&nbsp;</P>
<P>&nbsp;&nbsp;</P>
<P><SPAN class=RVTS1>Public Procedures</SPAN></P>
<P><SPAN class=RVTS2>procedure pwm_osc_init</SPAN></P>
<P>-- initializes the PWM oscillator and starts the PWM oscillator</P>
<P>&nbsp;&nbsp;</P>
<P><SPAN class=RVTS2>procedure pwm_osc_start</SPAN></P>
<P>-- starts the PWM oscillator</P>
<P>-- (initializing should have done prior with PWM_OSC_INIT)</P>
<P>&nbsp;&nbsp;</P>
<P><SPAN class=RVTS2>procedure pwm_osc_stop</SPAN></P>
<P>-- stops the PWM oscillator</P>
</BODY></HTML>
