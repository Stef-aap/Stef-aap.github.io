<html>
<head>
<title>JALcc SourceCode exporting of hd44780_4_ins_source.html</title>
</head>
<!-- Generated by SynEdit HTML exporter -->
<body text="#000000" bgcolor="#FFFFFF">
<pre>
<code><font  size=3 face="Courier New"><font color="#000080"><A href="hd44780_4_ins.jal">download&nbsp;hd44780_4_ins.jal</A>
</font><font color="#808080"><i>-- ----------------------------------------------------------------------------
-- Currently 2 string-tables are definied, but this can easily be extended,
-- by changing the code in HD44780_4.
--
-- There's also a table definied, for loading the free positions in the character
-- rom.
--
-- The LCD library HD44780_4 is automatic included by this file.
-- ----------------------------------------------------------------------------



-- ----------------------------------------------------------------------------
-- Define all the LCD control lines, they may be completly random
-- (note that some IO-pins need a pullup resistor, like A4 on 16F628)
-- ----------------------------------------------------------------------------
</i></font><font color="#000080"><b>&lt;</b></font><font color="#800080"><i>mac</i></font><font color="#000080"><b>&gt; </b>io_pin  HD44780_DataCmd <b>= </b>pin_c0
<b>&lt;</b></font><font color="#800080"><i>mac</i></font><font color="#000080"><b>&gt; </b>io_pin  HD44780_Enable <b>= </b>pin_c5
<b>&lt;</b></font><font color="#800080"><i>mac</i></font><font color="#000080"><b>&gt; </b>io_pin  HD44780_b4 <b>= </b>pin_d1
<b>&lt;</b></font><font color="#800080"><i>mac</i></font><font color="#000080"><b>&gt; </b>io_pin  HD44780_b5 <b>= </b>pin_d3
<b>&lt;</b></font><font color="#800080"><i>mac</i></font><font color="#000080"><b>&gt; </b>io_pin  HD44780_b6 <b>= </b>pin_a2
<b>&lt;</b></font><font color="#800080"><i>mac</i></font><font color="#000080"><b>&gt; </b>io_pin  HD44780_b7 <b>= </b>pin_d2
</font><font color="#808080"><i>-- ----------------------------------------------------------------------------


-- ----------------------------------------------------------------------------
-- If the datalines (and/or the Command/Data selectline) are multiplexed with other
-- devices, then HD44780_multiplexed_output must be set to true,
-- to ensure these lines are set explictly to output before addressing the LCD,
-- otherwsie, set the constant false to save program memory and time
-- ----------------------------------------------------------------------------
</i></font><b>const </b><font color="#000080">HD44780_multiplexed_output <b>= </b></font><font color="#FF0000">false
</font><font color="#808080"><i>-- ----------------------------------------------------------------------------


-- ----------------------------------------------------------------------------
-- define the actual display size
-- (all routines are tested at 2*16)
-- ----------------------------------------------------------------------------
</i></font><b>const </b><font color="#000080">LCD_number_of_display_lines      <b>= </b></font><font color="#FF0000">2
</font><b>const </b><font color="#000080">LCD_number_of_display_characters <b>= </b></font><font color="#FF0000">16
</font><font color="#808080"><i>-- ----------------------------------------------------------------------------


-- ----------------------------------------------------------------------------
-- constants, definining the positions of the animated characters in the
-- character rom, must be in the range of [0..7]
-- ----------------------------------------------------------------------------
</i></font><b>const byte </b><font color="#000080">LCD_animate1_pos <b>= </b></font><font color="#FF0000">2
</font><b>const byte </b><font color="#000080">LCD_animate2_pos <b>= </b></font><font color="#FF0000">3
</font><b>const byte </b><font color="#000080">LCD_animate3_pos <b>= </b></font><font color="#FF0000">4
</font><font color="#808080"><i>-- ----------------------------------------------------------------------------


-- ----------------------------------------------------------------------------
-- here the strings of table 1 are definied
-- maximum tablelength is 255
-- every string is terminated with a NULL
--   a slightly more efficient way is to use bit 7 as end of string,
--   but there are 2 problems,
--   1. JAL doesn't accept  &quot;retlw  &quot;t&quot; + 0x80&quot;
--   2. the second half of the characterset (which contains some greek
--      symbols, cann't be reached
-- The length of each string must be declared just afterwards.
-- ----------------------------------------------------------------------------
</i></font><font color="#000080"><b>&lt;</b></font><font color="#800080"><i>macro</i></font><font color="#000080"><b>&gt;
   </b>stringtable  _string_table_1
     string0      </font><font color="#808000">&quot;An Example&quot;                              </font><font color="#808080"><i>-- index 0
     </i></font><font color="#000080">string0      </font><font color="#808000">&quot;This is a long line, to test scrolling&quot;  </font><font color="#808080"><i>-- index 1
     </i></font><font color="#000080">string0      </font><font color="#808000">&quot;Short&quot;                                   </font><font color="#808080"><i>-- index 2
     </i></font><font color="#000080">string0      </font><font color="#808000">&quot;Animations&quot;                              </font><font color="#808080"><i>-- index 3
   </i></font><font color="#000080">stringtable_end
<b>&lt;/</b></font><font color="#800080"><i>macro</i></font><font color="#000080"><b>&gt;
</b></font><font color="#808080"><i>-- ----------------------------------------------------------------------------



-- ----------------------------------------------------------------------------
-- string-table 2
-- ----------------------------------------------------------------------------
</i></font><b>procedure </b><font color="#000080">_string_table_2 </font><b>is
   </b><font color="#800080"><i>pragma </i></font><font color="#000080">jump_table
   </font><font color="#800080"><i>assembler
      </i></font><font color="#000080">addwf PCL<b>, </b>f
        retlw   </font><font color="#808000">&quot;h&quot;  </font><font color="#808080"><i>-- start of first string (index = 0)
        </i></font><font color="#000080">retlw   </font><font color="#808000">&quot;a&quot;
        </font><font color="#000080">retlw   </font><font color="#808000">&quot;h&quot;
        </font><font color="#000080">retlw   </font><font color="#808000">&quot;a&quot;
        </font><font color="#000080">retlw   </font><font color="#FF0000">0   
   </font><b>end </b><font color="#800080"><i>assembler
</i></font><b>end procedure
</b><font color="#808080"><i>-- ----------------------------------------------------------------------------



-- ----------------------------------------------------------------------------
-- here the strings of the self generated characters are definied
-- maximum tablelength is 255
-- every character is definied by 8 words of 5 bits each
-- ----------------------------------------------------------------------------
</i></font><b>procedure </b><font color="#000080">_string_table_character_generator </font><b>is
   </b><font color="#800080"><i>pragma </i></font><font color="#000080">jump_table
   </font><font color="#800080"><i>assembler
      </i></font><font color="#000080">addwf PCL<b>, </b>f
        retlw   </font><font color="#FF0000">0b_00100  </font><font color="#808080"><i>-- arrow up
        </i></font><font color="#000080">retlw   </font><font color="#FF0000">0b_01110
        </font><font color="#000080">retlw   </font><font color="#FF0000">0b_10101
        </font><font color="#000080">retlw   </font><font color="#FF0000">0b_00100
        </font><font color="#000080">retlw   </font><font color="#FF0000">0b_00100
        </font><font color="#000080">retlw   </font><font color="#FF0000">0b_00100
        </font><font color="#000080">retlw   </font><font color="#FF0000">0b_00100
        </font><font color="#000080">retlw   </font><font color="#FF0000">0b_00100
        
        </font><font color="#000080">retlw   </font><font color="#FF0000">0b_00100  </font><font color="#808080"><i>-- arrow down
        </i></font><font color="#000080">retlw   </font><font color="#FF0000">0b_00100
        </font><font color="#000080">retlw   </font><font color="#FF0000">0b_00100
        </font><font color="#000080">retlw   </font><font color="#FF0000">0b_00100
        </font><font color="#000080">retlw   </font><font color="#FF0000">0b_00100
        </font><font color="#000080">retlw   </font><font color="#FF0000">0b_10101
        </font><font color="#000080">retlw   </font><font color="#FF0000">0b_01110
        </font><font color="#000080">retlw   </font><font color="#FF0000">0b_00100
        

   </font><b>end </b><font color="#800080"><i>assembler
</i></font><b>end procedure
</b><font color="#808080"><i>-- ----------------------------------------------------------------------------


-- ----------------------------------------------------------------------------
-- here the actual LCD library is included
-- ----------------------------------------------------------------------------
</i></font><font color="#FF00FF">include hd44780_4

</font></font>
</code></pre>
</body>
</html>
